# YuCoder 聊天室插件

这是一个VSCode扩展插件，可以让你在VSCode中直接使用YuCoder聊天室功能。

## 功能特性

- 🔌 WebSocket实时连接
- 💬 实时收发聊天消息
- 📜 自动加载历史消息
- 👥 显示在线用户列表
- 🔄 自动重连机制
- 💓 自动心跳保活
- 🖼️ 智能图片显示（支持点击查看）
- ⚙️ 丰富的个性化配置选项
- 👤 可控的头像显示
- 🎨 简洁美观的UI设计
- 💾 状态保持（隐藏/显示不丢失状态）

## 安装和使用

### 开发环境设置

1. 克隆或下载项目代码
2. 在项目目录中运行：
   ```bash
   npm install
   ```

3. 编译TypeScript代码：
   ```bash
   npm run compile
   ```

### 在VSCode中测试插件

1. 在VSCode中打开此项目
2. 按 `F5` 运行插件（会打开一个新的VSCode扩展开发主机窗口）
3. 在新窗口中，查看活动栏左侧的聊天图标
4. 点击聊天图标打开聊天面板

### 配置和使用

#### 第一步：配置Token
1. **获取Token**：访问 [yucoder.cn](https://yucoder.cn) 登录后获取你的Token
2. **配置Token**：
   - 打开VSCode设置：`文件` → `首选项` → `设置`
   - 搜索 "YuCoder"
   - 在 "YuCoder Chat: Token" 中输入你的Token

#### 第二步：个性化设置
- **显示头像**：控制是否显示用户头像
- **显示图片**：控制是否自动显示图片（关闭时点击可查看）

#### 第三步：开始聊天
1. 点击左侧聊天图标打开聊天面板
2. 点击"连接"按钮
3. 系统会自动验证Token并获取用户信息
4. 验证成功后即可开始聊天

⚠️ **注意**：如果提示"Token无效"，请检查：
- Token是否在设置中正确配置
- Token是否已过期
- 网络连接是否正常

## 命令

插件注册了以下命令：

- `YuCoder: 打开聊天室` - 打开聊天室面板

## 技术实现

- **WebSocket连接**：使用`wss://api.yucoder.cn/ws/`进行实时通信
- **用户信息**：自动获取真实用户资料用于发送消息
- **消息格式**：支持文本和图片消息
- **心跳保活**：每25秒发送一次心跳消息
- **历史消息**：通过API获取聊天历史记录

## 目录结构

```
├── src/
│   ├── extension.ts       # 插件入口文件
│   ├── chatViewProvider.ts # 聊天视图提供者
│   └── chatService.ts     # 聊天服务类
├── package.json          # 插件配置和依赖
├── tsconfig.json         # TypeScript配置
└── README.md            # 说明文档
```

## 开发和调试

1. 修改代码后运行 `npm run compile` 重新编译
2. 在扩展开发主机中按 `Ctrl+R` (Windows/Linux) 或 `Cmd+R` (Mac) 重新加载插件
3. 查看开发者控制台获取调试信息

## 注意事项

- 需要有效的YuCoder Token才能连接聊天室
- 插件会自动处理连接断开和重连
- 聊天消息在VSCode重启后不会保留

## 许可证

MIT License 